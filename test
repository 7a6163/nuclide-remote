#!/usr/bin/env bats


source ./utils

setup () {
    status "Query GitHub API to get the latest stable tag"
    export IMAGE_TAG=$(latestTag)
    msg $IMAGE_TAG
}

run () {
    docker run --rm "$IMAGE_NAME:$IMAGE_TAG" "$@"
}

@test "nuclide-start-server is in PATH" {
   run which nuclide-start-server >/dev/null 2>&1
}

@test "nuclide module version" {
   [ "$(run npm list -g nuclide | grep -oE '@[0-9\.]+' | tr -d '@\n')" == "$IMAGE_TAG" ]
}
